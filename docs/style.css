:root{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  --bottomBarH: 160px;
}

body{
  margin:0;
  background:#0e1622;
  color:#e8eef7;
  padding-bottom: calc(var(--bottomBarH) + env(safe-area-inset-bottom));
}

/* ===== TOP BAR ===== */
.topbar{
  padding:12px 16px;
  border-bottom:1px solid #1d2a3a;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}

.brand{
  display:flex;
  align-items:center;
  gap:10px;
}

.brand img{
  height:48px;
}

.brand span{
  font-weight:600;
  letter-spacing:1px;
  font-size:14px;
  opacity:.9;
}

.row{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}

.hiddenFile{
  position:absolute;
  left:-9999px;
}

.uploadBtn{
  font-weight:600;
  border-radius:12px;
  padding:10px 12px;
}

/* ===== LAYOUT ===== */
main{
  display:grid;
  grid-template-columns:320px 1fr 320px;
  gap:12px;
  padding:12px;
}

/* ===== PANELS ===== */
.panel{
  background:#141f2d;
  border:1px solid #22344a;
  border-radius:12px;
  padding:14px;
  min-height:0;
}

/* ===== TEXT HELPERS ===== */
.sectionHint{
  font-size:12px;
  opacity:.72;
  margin:-6px 0 10px 0;
  line-height:1.35;
}

.sectionTitle{
  font-weight:700;
  font-size:18px;
  margin-bottom:6px;
}

.sectionMeta{
  font-size:12px;
  opacity:.75;
  line-height:1.35;
}

/* ===== VIEWER ===== */
.viewer{
  background:#0c1420;
  border:1px solid #22344a;
  border-radius:12px;
  padding:12px;
  overflow:auto;
}

canvas{
  width:100%;
  background:#fff;
  border-radius:6px;
}

/* ===== INPUTS ===== */
input[type="text"],
textarea,
select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #243348;
  background:#0b0f14;
  color:#e8eef7;
}

textarea{ resize:vertical; }

/* ===== BUTTONS ===== */
button{
  padding:8px 10px;
  border-radius:10px;
  border:1px solid #2a3d57;
  background:#162235;
  color:#e8eef7;
  cursor:pointer;
}

button:hover:not(:disabled){
  background:#1d2f47;
}

button:disabled{
  opacity:.45;
  cursor:not-allowed;
}

/* ===== LEFT PANEL (DESKTOP) ===== */
.panelLeft{
  display:flex;
  flex-direction:column;
}

.sectionsList{
  max-height:40vh;
  overflow-y:auto;
  padding-right:6px;
}

/* ===== SEARCH RESULTS ===== */
.results{
  margin-top:10px;
  padding:8px;
  border-radius:10px;
  border:1px solid #243348;
  background:#0b0f14;
  max-height:40vh;
  overflow-y:auto;
}

#searchResults .hit,
#searchResults div{
  display:block;
  padding:10px 12px;
  margin:8px 0;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.06);
}

/* ===== RIGHT PANEL ===== */
.panelRight{
  display:flex;
  flex-direction:column;
}

.answer{
  margin-top:10px;
  white-space:pre-wrap;
  background:#0b0f14;
  border:1px solid #243348;
  border-radius:12px;
  padding:12px;
  min-height:120px;
  line-height:1.35;
}

.safetyLine{
  margin-top:10px;
  font-size:12px;
  opacity:.75;
}

/* ===== TTS CONTROLS ===== */
#ttsControls{
  margin-top:10px;
  padding:10px;
  border-top:1px solid rgba(255,255,255,.08);
}

/* ===== MOBILE ===== */
.bottomBar{
  display:none;
}

@media (max-width: 900px){
  main{
    grid-template-columns:1fr;
  }
}

@media (max-width: 768px){
  /* Mobile uses page scroll only */
  .panelLeft,
  .panelRight,
  .sectionsList,
  .results{
    max-height:none;
    overflow:visible;
  }

  .bottomBar{
    display:flex;
    position:fixed;
    left:10px;
    right:10px;
    bottom:10px;
    gap:10px;
    z-index:9999;
    padding:10px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.12);
    background:rgba(20,32,48,.85);
    backdrop-filter:blur(8px);
    height:var(--bottomBarH);
    padding-bottom:env(safe-area-inset-bottom);
  }

  .bottomBtn{
    flex:1;
    padding:14px 12px;
    border-radius:14px;
    font-weight:600;
    font-size:15px;
  }
}

@media (prefers-reduced-motion: reduce){
  *{ scroll-behavior:auto; }
}

/* =========================
   HOTFIX: iOS bottom bar + left panel
   ========================= */

/* 1) Keep LEFT PANEL content bounded (prevents "endless sections") */
@media (max-width: 768px){
  /* Make the left panel a bounded container */
  .panelLeft{
    max-height: calc(100vh - var(--bottomBarH) - 24px);
    overflow: hidden;
  }

  /* Allow sections list + search results to scroll inside */
  .sectionsList{
    max-height: 32vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  #searchResults{
    max-height: 32vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* 2) Remove the "black cards" look from the bottom buttons */
@media (max-width: 768px){
  /* Make the bottom bar slim like native */
  :root{ --bottomBarH: 86px; }

  .bottomBar{
    height: var(--bottomBarH);
    padding: 10px 12px;
  }

  /* Buttons: small pills instead of giant cards */
  .bottomBtn{
    height: 52px;
    padding: 0 12px;
    border-radius: 16px;

    /* remove heavy card look */
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.10);
  }

  .bottomBtn.primary{
    font-weight: 700;
    background: rgba(255,255,255,0.10);
  }
}